# Название
Старый знакомый

# Описание
run-and-hide - мини игра, отсылающая к одному всеми известному персонажу.

# Легенда
На просторах интернета есть маленькая игрушка, которая, почему то попадается в рекомендациях именно вам - любителю крипипаст, аналоговых хорроров и жутких историй. Может стоит вспомнить некоторые из них?

# теги
- crypto
- reverse
- misc

# Сложность: medium

# инструкция по развёртыванию
Предоставить файл run-and-hide.exe из \dist

# Как заменить флаг
В run-and-hide.py в 30 строке заменить строку на необходимую
```python
flag = xor_encrypt(r"HITS{new_flag}", "slenderman")
```
Пересобрать exe через pyinstaller
```sh
python -m PyInstaller --onefile --add-data "sm_melody.mp3;."  .\run-and-hide.py
```
Необходимые модули
```sh
pip install colorama
pip install pylistaller
pip install playsound==1.2.2 #Версия важна
```

# Решение
1. При внимательном рассмотрении, иконка самого приложения содержит подсказку на используемый язык (стандартная иконка для pyinstaller)
2. В ходе игры и перебора возможных уязвимостей, находим, что вводимые данные выполняются через eval или exec функции => RCE
3. через print(globals()) можно найти зашифрованный flag, xor_encrypt() и xor_decrypt(). 
4. Методом тыка (или через import inspect -> print(inspect.signature(xor_decrypt))) можно узнать, какие аргументы принимает xor_decrypt() (это encoded_msg и key). Остаётся лишь узнать ключ
5. run-and-hide пропитана отсылками на слендермена (мелодия победы, "записки" на деревьях, наводящие сообщения). Собственно "slenderman" и является ключом. Альтернативно, возможен брутфорс.
6. print(xor_decrypt(flag, "slenderman")) выведет флаг
